# 模型分析总结 (T1_analysis_v13.py)

## 1. 数据预处理与特征工程

- **数据清洗**: 脚本 `data_clean_v13.py` 统一了孕周格式，并移除了关键变量（孕周、Y染色体浓度、孕妇BMI）存在缺失值的样本。
- **特征标准化**: 对 "在参考基因组上比对的比例", "重复读段的比例", "GC含量" 等数值特征进行了标准化处理，以消除量纲影响。
- **共线性诊断**: 计算了相关系数矩阵和方差膨胀因子 (VIF)。结果显示，各预测变量之间不存在严重的多重共线性问题 (所有VIF值均远小于5)。

## 2. 逻辑回归模型

为了解决模型拟合过程中的完全分离问题 (`Singular matrix` error)，我们将连续的 `Y染色体浓度` 转换为了一个二元分类变量 `Y_binary` (基于中位数分割)。

- **模型1 (基础模型)**: 不包含交互项。
- **模型2 (扩展模型)**: 包含了 `孕周` 和 `孕妇BMI` 的交互项 (`孕周_BMI交互`)。

### 模型比较 (似然比检验)

- **似然比统计量**: 14.2552
- **p值**: 0.0008
- **结论**: **拒绝原假设**。结果表明，包含交互项的扩展模型显著优于基础模型。这说明孕周和孕妇BMI对Y染色体浓度的影响并非简单的线性叠加，而是存在交互效应。

### 扩展模型系数分析

- 在扩展模型中，`重复读段的比例_标准化` 是唯一一个在统计上显著的线性预测因子 (p < 0.05)。
- `孕周_BMI交互` 项本身不显著，但其在似然比检验中的整体贡献是显著的，这支持了在模型中保留该交互项的决定。

## 3. 广义可加模型 (GAM)

为了捕捉 `孕周` 和 `孕妇BMI` 可能存在的非线性关系，我们进一步构建了GAM模型。

- **模型性能**:

  - **McFadden's Pseudo R²**: **0.5190**
  - **结论**: GAM模型对数据的拟合效果非常好，解释了因变量约51.9%的变异。远高于传统线性模型，证明了在Y染色体浓度预测中考虑非线性关系的重要性。
- **偏依赖图 (Partial Dependence Plots)**:

  - 生成的 `GAM_partial_dependence.png` 可视化了 `孕周` 和 `孕妇BMI` 对Y染色体浓度（的对数几率）的非线性影响。这些图表为了解这两个关键变量如何独立地影响Y染色体浓度提供了直观的洞见。

## 总结

通过一系列的模型迭代与优化，我们最终确定了GAM是预测Y染色体浓度的最优模型。分析表明，孕周和孕妇BMI对Y染色体浓度存在显著的、非线性的交互影响。`重复读段的比例` 也是一个重要的预测因素。

# 多重共线性检验

T1_analysis_v13.py 脚本 进行了GAM关键的前提检验 ，即通过VIF排除了变量间严重的多重共线性。这是一个非常好的建模实践，确保了后续模型分析结果的可靠性。

# @Bulider

M1Doubao-Seed-1.6

# @Developer

M1 Gemini-2.5-Pro
