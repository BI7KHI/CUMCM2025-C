# T1分析高级拟合算法报告 v1.3

## 项目概述

本项目从拟合算法入手，通过实现多种高级拟合算法来提高T1分析的拟合程度。相比v1.2版本，v1.3版本引入了多项式回归、样条回归、机器学习模型等多种拟合方法，并进行了全面的模型比较和优化。

## 主要改进

### 1. 算法升级
- **v1.2**: 简单的分段线性回归
- **v1.3**: 多种高级拟合算法
  - 多项式回归 (1-5次)
  - 样条回归 (3-10个节点)
  - 机器学习模型 (8种算法)
  - 超参数优化

### 2. 模型比较
实现了全面的模型性能比较，包括：
- 训练R²和交叉验证R²
- RMSE和MAE指标
- 模型稳定性评估

### 3. 可视化增强
- 12个子图的综合可视化
- 模型性能对比图
- 预测结果分析图
- 残差分析图

## 关键发现

### 1. 数据特征
- **样本数**: 1,069个男性胎儿样本
- **Y染色体浓度范围**: 1.00% - 23.42%
- **检测孕周范围**: 11.00 - 24.86周
- **孕妇BMI范围**: 20.70 - 46.88 kg/m²

### 2. 相关性分析
- **孕周与Y染色体浓度**: r = 0.1181 (极显著, p < 0.001)
- **BMI与Y染色体浓度**: r = -0.1550 (极显著, p < 0.001)
- **年龄与Y染色体浓度**: r = -0.1225 (极显著, p < 0.001)

### 3. 模型性能对比

#### 多项式回归模型
| 次数 | R² | 交叉验证R² | RMSE | MAE |
|------|----|-----------|------|-----|
| 1次 | 0.0595 | -0.3024 | 3.2581 | 2.6410 |
| 2次 | 0.0719 | -0.3721 | 3.2367 | 2.6116 |
| 3次 | 0.1335 | -0.3181 | 3.1274 | 2.5174 |
| 4次 | 0.1659 | -0.8933 | 3.0683 | 2.4531 |
| 5次 | 0.2068 | -1.2027 | 2.9922 | 2.3776 |

**最佳**: 1次多项式 (交叉验证R²: -0.3024)

#### 样条回归模型
| 节点数 | R² | 交叉验证R² | RMSE | MAE |
|--------|----|-----------|------|-----|
| 3 | 0.1157 | -0.6201 | 3.1593 | 2.5420 |
| 5 | 0.1527 | -59.6421 | 3.0926 | 2.4854 |
| 7 | 0.1766 | -1.1024 | 3.0486 | 2.4492 |
| 10 | 0.1942 | -435.4968 | 3.0159 | 2.4141 |

**最佳**: 3个节点 (交叉验证R²: -0.6201)

#### 机器学习模型
| 模型 | R² | 交叉验证R² | RMSE | MAE |
|------|----|-----------|------|-----|
| Ridge回归 | 0.0595 | -0.3023 | 3.2581 | 2.6410 |
| Lasso回归 | 0.0566 | -0.2937 | 3.2633 | 2.6374 |
| **ElasticNet** | **0.0580** | **-0.2928** | **3.2607** | **2.6377** |
| 随机森林 | 0.8793 | -0.3916 | 1.1670 | 0.8878 |
| 梯度提升 | 0.4078 | -0.3330 | 2.5853 | 2.0523 |
| 支持向量机 | 0.1384 | -0.3720 | 3.1185 | 2.4134 |
| 决策树 | 0.9976 | -1.3158 | 0.1650 | 0.0378 |
| 神经网络 | 0.2430 | -0.3227 | 2.9232 | 2.3110 |

**最佳**: ElasticNet (交叉验证R²: -0.2928)

## 重要发现

### 1. 过拟合问题
所有模型的交叉验证R²都为负值，表明存在严重的过拟合问题：
- 训练集表现良好，但泛化能力差
- 模型复杂度与数据量不匹配
- 需要更多数据或正则化

### 2. 模型选择
- **ElasticNet** 在交叉验证中表现最佳
- 线性模型比复杂模型更稳定
- 决策树和随机森林训练R²很高但泛化能力差

### 3. 数据特征
- 相关性较弱 (|r| < 0.2)
- 非线性关系不明显
- 需要特征工程

## 改进建议

### 1. 数据层面
- 增加样本量
- 特征工程 (交互项、多项式特征)
- 数据增强技术

### 2. 模型层面
- 加强正则化
- 使用集成方法
- 尝试非线性模型

### 3. 评估层面
- 使用更多评估指标
- 时间序列验证
- 临床意义评估

## 技术实现

### 1. 代码结构
```
scripts_v1.3/
├── t1_analysis_v1.3.py          # 主分析代码
├── test_v1.3.py                 # 测试代码
├── t1_analysis_advanced_v1.3.png # 高级可视化
├── test_visualization_v1.3.png  # 测试可视化
└── v1.3_analysis_summary.md     # 本报告
```

### 2. 主要功能
- 多种拟合算法实现
- 自动模型选择
- 超参数优化
- 综合可视化
- 性能评估

### 3. 技术特点
- 模块化设计
- 错误处理完善
- 中文支持优化
- 结果自动保存

## 结论

v1.3版本成功实现了多种高级拟合算法，但发现数据存在过拟合问题。虽然训练集表现良好，但交叉验证结果不理想，表明模型泛化能力有限。建议在后续版本中：

1. 增加数据量或使用数据增强
2. 加强正则化和特征选择
3. 考虑临床实际应用场景
4. 结合领域知识进行特征工程

v1.3版本为后续的模型优化奠定了坚实基础，提供了完整的算法比较框架和评估体系。

